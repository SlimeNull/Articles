<!doctype html><html lang=zh-cn dir=content/zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=content-security-policy content="upgrade-insecure-requests"><title>PowerShell 快速入门, 基本语法, 常用类型, 函数, .NET 互操作 - 诺尔的小窝</title><meta name=keywords content="史莱姆诺尔,萌诺尔,诺尔,博客,程序员,自学,编程,笔记,技术,分享,.NET,C#"><meta name=author content="史莱姆诺尔"><meta property="og:title" content="PowerShell 快速入门, 基本语法, 常用类型, 函数, .NET 互操作"><meta property="og:site_name" content="诺尔的小窝"><meta property="og:image" content="https://slimenull.topimg/author.jpg"><meta name=title content="PowerShell 快速入门, 基本语法, 常用类型, 函数, .NET 互操作 - 诺尔的小窝"><meta name=description content="为了更好的开源世界~"><link rel="shortcut icon" href=https://slimenull.topimg/favicon.ico><link rel=apple-touch-icon href=https://slimenull.topimg/apple-touch-icon.png><link rel=apple-touch-icon-precomposed href=https://slimenull.topimg/apple-touch-icon.png><link href=//unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css rel=stylesheet type=text/css><link href=//unpkg.com/imageviewer@1.1.0/dist/viewer.min.css rel=stylesheet><link href=https://slimenull.topcss/main.css rel=stylesheet type=text/css><link href=https://slimenull.topcss/syntax.css rel=stylesheet type=text/css></head><body itemscope itemtype=http://schema.org/WebPage lang=zh-hans><div class="container one-collumn sidebar-position-left page-home"><div class=headband></div><header id=header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle role=button style=opacity:1;top:0><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><div class=custom-logo-site-title><a href=/ class=brand rel=start><span class=logo-line-before><i></i></span>
<span class=site-title>诺尔的小窝</span>
<span class=logo-line-after><i></i></span></a></div><p class=site-subtitle>前进! 前进! 不择手段的前进!</p></div><div class=site-nav-right><div class="toggle popup-trigger" style=opacity:1;top:0><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul id=menu class=menu><li class=menu-item><a href=/ rel=section><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-active"><a href=/post rel=section><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class=menu-item><a href=/about.html rel=section><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于我</a></li><li class=menu-item><a href=/404.html rel=section><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益404</a></li><li class="menu-item menu-item-search"><a href=javascript:; class=popup-trigger><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class=site-search><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class=search-icon><i class="fa fa-search"></i></span>
<span class=popup-btn-close><i class="fa fa-times-circle"></i></span><div class=local-search-input-wrapper><input autocomplete=off placeholder=搜索关键字... spellcheck=false type=text id=local-search-input autocapitalize=none autocorrect=off></div></div><div id=local-search-result></div></div></div></nav></div></header><main id=main class=main><div class=main-inner><div class=content-wrap><div id=content class=content><section id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href=https://slimenull.top/post/pwsh-getstarted/ itemprop=url>PowerShell 快速入门, 基本语法, 常用类型, 函数, .NET 互操作</a></h1><div class=post-meta><span class=post-pushdate><i class="fa fa-calendar-o fa-fw"></i>
<span class=post-meta-item-text>时间：</span>
<time itemprop=dateCreated datetime=2016-03-22T13:04:35+08:00 content="2021-03-24">2021-03-24</time></span>
<span class=post-wordcount><i class="fa fa-file-word-o fa-fw"></i>
<span class=post-meta-item-text>字数：</span>
<span class=leancloud-world-count>4086 字</span></span>
<span class=post-readtime><i class="fa fa-eye fa-fw"></i>
<span class=post-meta-item-text>阅读：</span>
<span class=leancloud-view-count>9分钟</span></span>
<span id=/post/pwsh-getstarted/ class="leancloud_visitors post-visitor" data-flag-title="PowerShell 快速入门, 基本语法, 常用类型, 函数, .NET 互操作"><i class="fa fa-binoculars fa-fw"></i>
<span class=post-meta-item-text>阅读次数：</span>
<span class=leancloud-visitors-count></span></span></div></header><div class=post-body itemprop=articleBody><p>PowerShell, 比 cmd 强大一万倍的 shell, 并且完美支持 .NET 互操作, 用来测试一些小功能最恰当不过</p><blockquote><p>开始之前, 我们认定你已经有一定的编程基础, 熟悉 .NET 中的类型与对象.</p><p>此文章对于 .NET 开发者来说更简单哦!</p></blockquote><p>在 PowerShell 中, 几乎一切都是对象. 与 CMD 有很大不同. PowerShell 是强类型的, 它基于 .NET, 故, PowerShell 可以近乎完美的调用 .NET 的标准库.</p><h2 id=0-准备工作>0. 准备工作</h2><h3 id=--官方文档>- 官方文档</h3><p>既然要学新东西, 肯定要会查阅官方文档才彳亍呀! 本文章参阅官方文档, 并使用更简单的语言讲述给读者, 在每一部分都会有推荐的官方文档链接目录, 点击即可跳转.</p><blockquote><p><a href="https://docs.microsoft.com/en-us/powershell/scripting/how-to-use-docs?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 如何使用 PowerShell 官方文档</a></p><p><a href="https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : PowerShell 是什么</a></p><p><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_arrays?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于主题 (涵盖有关 PowerShell 的一系列概念)</a></p></blockquote><p>另外, 在文档的中文页面的左侧索引部分, 你无法看到所有的内容, 例如 Reference 分类, 其中包含了非常多的 &lsquo;隐藏&rsquo; 内容, 只有你切换到英文页面才可以看到它们.</p><p>至于如何切换页面语言, 也简单, 只需要将地址栏中的 &lsquo;zh-cn&rsquo; 改为 &rsquo;en-us&rsquo; 即可, 同理, 如果某个页面你看不懂, 想要切换到中文, 可以将 &rsquo;en-us&rsquo; 改为 &lsquo;zh-cn&rsquo;, 不过需要注意的是, 部分页面是没有提供中文翻译的.</p><p>为了方便, 本文涉及到的所有文档链接均为英文直链, 如需访问中文页面, 请自行修改链接地址.</p><h3 id=--启动-powershell>- 启动 PowerShell</h3><p>PowerShell 同 CMD 一样有许多启动方式, 准备好开始了吗? 那么开始吧!</p><ol><li><p>按下 &ldquo;Win&rdquo; + &ldquo;R&rdquo; 打开 &lsquo;运行&rsquo; 窗口, 键入 &lsquo;PowerShell&rsquo; 并确认.</p></li><li><p>按 &ldquo;Win&rdquo; + X, 然后按 &lsquo;I&rsquo;, 或者按 &lsquo;A&rsquo;(以管理员身份运行).</p></li><li><p>在桌面或资源管理器, 不选中任何条目, 按住 Shift, 右击背景, 在弹出的菜单中选择 &lsquo;在此处启动 PowerShell&rsquo;.</p></li><li><p>在资源管理器中, 在地址栏输入 &lsquo;PowerShell&rsquo; 并按 Enter 键确认.</p></li></ol><p>接下来, 出现的蓝底白字的控制台页面就是 PowerShell 的主程序了! 在其中输入指令(代码)可以运行一些东西.</p><h2 id=1-基本语法>1. 基本语法</h2><h3 id=--标准输出>- 标准输出</h3><p>让我们从一个 &lsquo;hello world&rsquo; 的输出开始吧, 与 CMD, Bash 一样, 使用 echo 指令是可以输出内容的.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b44>&#34;Hello World!&#34;</span>
</span></span></code></pre></div><p>输出:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>Hello World!
</span></span></code></pre></div><h3 id=--获取帮助>- 获取帮助:</h3><p>执行以下指令来获取关于 echo 的帮助内容.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f>Get-Help</span> <span style=color:#a2f>echo
</span></span></span></code></pre></div><p>输出:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>NAME
</span></span><span style=display:flex><span>    Write-Output
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SYNTAX
</span></span><span style=display:flex><span>    Write-Output [-InputObject] &lt;psobject[]&gt; [-NoEnumerate]  [&lt;CommonParameters&gt;]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ALIASES
</span></span><span style=display:flex><span>    write
</span></span><span style=display:flex><span>    echo
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>REMARKS
</span></span><span style=display:flex><span>    Get-Help cannot find the Help files for this cmdlet on this computer. It is displaying only partial help.
</span></span><span style=display:flex><span>        -- To download and install Help files for the module that includes this cmdlet, use Update-Help.
</span></span><span style=display:flex><span>        -- To view the Help topic for this cmdlet online, type: &#34;Get-Help Write-Output -Online&#34; or
</span></span><span style=display:flex><span>           go to https://go.microsoft.com/fwlink/?LinkID=113427.     
</span></span></code></pre></div><p>看到结果, 你懂了吧, echo 实际上是 Write-Output 的别名, 同时也可以用 write 来执行.</p><p>另外, PowerShell 的指令是不区分大小写的, 所以 Write-Output 与 wRITE-oUTPUT 是一样执行效果的</p><h3 id=--定义变量>- 定义变量</h3><blockquote><p><a href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_variables target=_blank rel=noopener>PowerShell 官方文档 : 关于变量</a></p></blockquote><p>定义变量的方式与 Bash 差不多, 都是用 $ 开头, 后跟变量名</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$var</span> = 123
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$var</span>
</span></span></code></pre></div><p>输出:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>123
</span></span></code></pre></div><h3 id=--固定常量>- 固定常量</h3><p>PowerShell 中有一些常量, 不可被赋值 (如果对其赋值, 不会产生任何作用, 且不会抛出异常)</p><table><thead><tr><th>常量名</th><th>类型</th><th>值</th></tr></thead><tbody><tr><td>$null</td><td>object</td><td>null</td></tr><tr><td>$true</td><td>bool</td><td>true</td></tr><tr><td>$false</td><td>bool</td><td>false</td></tr></tbody></table><p>如果访问一些未定义的变量, 返回的值同样是 null</p><h3 id=--类型概念>- 类型概念</h3><p>PowerShell 是强类型的. 例如刚刚我们定义的变量, 其实就是一个 int 变量. 示例:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$a</span> = 123
</span></span><span style=display:flex><span><span style=color:#b8860b>$b</span> = 321
</span></span><span style=display:flex><span><span style=color:#b8860b>$c</span> = <span style=color:#b8860b>$a</span> + <span style=color:#b8860b>$b</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$c</span>
</span></span></code></pre></div><p>输出:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>444
</span></span></code></pre></div><p>数字支持运算, 所以理所当然的可以进行运算.</p><h3 id=--表达式与指令>- 表达式与指令</h3><p>刚刚我们所用的 echo 指令, 同时可以说是一个表达式. 而刚刚我们进行加法运算时, 所使用的 &lsquo;$a + $b&rsquo; 通用</p><p>我没猜错的话, 在刚刚的变量部分, 也同样有人这么执行:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$a</span> = 123
</span></span><span style=display:flex><span><span style=color:#b8860b>$b</span> = 321
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$a</span> + <span style=color:#b8860b>$b</span>
</span></span></code></pre></div><p>然后结果就是, 输出了</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>$a + $b
</span></span></code></pre></div><p>而解决办法就是, 为这个表达式加上括号, 优先运算这个表达式, 于是就正常了, 或者你可以直接 echo 一个表达式:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f>echo </span>(123+321)
</span></span></code></pre></div><p>输出</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>444
</span></span></code></pre></div><h3 id=--运算符>- 运算符</h3><p>刚刚我们从尝试了加法运算, 同时在 PowerShell 中, 也是支持减法, 乘法, 除法的, 除此之外还有小于, 大于, 等于, 大于等于, 小于等于:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f>echo </span>(1 <span style=color:#666>-lt</span> 10)
</span></span></code></pre></div><p>输出:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>True
</span></span></code></pre></div><table><thead><tr><th>运算符</th><th>描述</th></tr></thead><tbody><tr><td>-eq</td><td>等于</td></tr><tr><td>-ne</td><td>不等于</td></tr><tr><td>-lt</td><td>小于</td></tr><tr><td>-gt</td><td>大于</td></tr><tr><td>-le</td><td>小于等于</td></tr><tr><td>-ge</td><td>大于等于</td></tr></tbody></table><h2 id=2-流程控制>2. 流程控制:</h2><h3 id=--基本判断>- 基本判断</h3><blockquote><p><a href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_if target=_blank rel=noopener>MSDocs PowerShell : 关于 If</a></p></blockquote><p>判断的话, 毋庸置疑是 if 语句. 当然, 无非是 &lsquo;if&rsquo; &rsquo;else&rsquo; &rsquo;else if&rsquo;</p><p>在 PowerShell 中, if 语句的语法可以是这样:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f;font-weight:700>if</span> (exp) {
</span></span><span style=display:flex><span>    statement block
</span></span><span style=display:flex><span>} <span style=color:#a2f;font-weight:700>elseif</span> {
</span></span><span style=display:flex><span>    statement block
</span></span><span style=display:flex><span>} <span style=color:#a2f;font-weight:700>else</span> {
</span></span><span style=display:flex><span>    statement block
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$randint</span> = (<span style=color:#a2f>New-Object</span> Random).Next()    <span style=color:#080;font-style:italic># 生成一个随机数, 并赋值给 randint 变量</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>if</span> (<span style=color:#b8860b>$randint</span> <span style=color:#666>-eq</span> 114514) {
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span><span style=color:#b44>&#34;嗯哼哼哼啊啊啊啊啊啊啊啊&#34;</span>
</span></span><span style=display:flex><span>} <span style=color:#a2f;font-weight:700>elseif</span> (<span style=color:#b8860b>$randint</span> <span style=color:#666>-gt</span> 114514) {
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span><span style=color:#b44>&#34;吔屎了你, 梁非凡!&#34;</span>
</span></span><span style=display:flex><span>} <span style=color:#a2f;font-weight:700>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span><span style=color:#b44>&#34;听不见! 就这点声音还想开军舰!?&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>没错, PowerShell 中, &rsquo;else if&rsquo; 的话是不允许带空格的. 并且需要注意的是, 这个大括号不允许省略.</p><h3 id=--循环语句>- 循环语句</h3><p>for 循环</p><blockquote><p><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_for?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于 For</a></p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f;font-weight:700>for</span> (exp; exp; exp) {
</span></span><span style=display:flex><span>    statement block
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>for</span> (<span style=color:#b8860b>$i</span> = 0; <span style=color:#b8860b>$i</span> <span style=color:#666>-lt</span> 10; <span style=color:#b8860b>$i</span>++) {
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span><span style=color:#b8860b>$i</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>for</span> (<span style=color:#b8860b>$i</span> = 1; <span style=color:#b8860b>$i</span> <span style=color:#666>-lt</span> 10; <span style=color:#b8860b>$i</span>++) {
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>for</span> (<span style=color:#b8860b>$j</span> = 1; <span style=color:#b8860b>$j</span> <span style=color:#666>-le</span> <span style=color:#b8860b>$i</span>; <span style=color:#b8860b>$j</span>++) {
</span></span><span style=display:flex><span>        <span style=color:#800>[Console]</span>::Write((<span style=color:#b44>&#34;{0}x{1}={2}</span><span style=color:#b62;font-weight:700>`t</span><span style=color:#b44>&#34;</span> <span style=color:#666>-f</span> (<span style=color:#b8860b>$j</span>, <span style=color:#b8860b>$i</span>, <span style=color:#b8860b>$i</span> * <span style=color:#b8860b>$j</span>)))   <span style=color:#080;font-style:italic># 不换行输出</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#800>[Console]</span>::WriteLine()    <span style=color:#080;font-style:italic># 换行</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>foreach 循环</p><blockquote><p><a href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_foreach target=_blank rel=noopener>MSDocs PowerShell : 关于 Foreach</a></p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f;font-weight:700>foreach</span> (<span style=color:#b8860b>$var</span> <span style=color:#a2f;font-weight:700>in</span> enumerable object) {
</span></span><span style=display:flex><span>    statement block
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>foreach</span> (<span style=color:#b8860b>$num</span> <span style=color:#a2f;font-weight:700>in</span> @(1..5)) {
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span><span style=color:#b8860b>$num</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>while 循环</p><blockquote><p><a href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_while target=_blank rel=noopener>MSDocs PowerShell : 关于 While</a></p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f;font-weight:700>while</span> (exp) {
</span></span><span style=display:flex><span>    statement block
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>打破循环:</p><blockquote><p><a href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_break target=_blank rel=noopener>MSDocs PowerShell : 关于 Break</a></p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#080;font-style:italic># 在 for 中打破循环 :</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>for</span> (<span style=color:#b8860b>$i</span> = 0; <span style=color:#b8860b>$i</span> <span style=color:#666>-lt</span> 10; <span style=color:#b8860b>$i</span>++) {
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>if</span> (<span style=color:#b8860b>$i</span> <span style=color:#666>-eq</span> 5) {
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>break</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span><span style=color:#b8860b>$i</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 在 foreach 语句中打破循环 :</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>foreach</span> (<span style=color:#b8860b>$i</span> <span style=color:#a2f;font-weight:700>in</span> @(1..10)) {
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>if</span> (<span style=color:#b8860b>$i</span> <span style=color:#666>-eq</span> 5) {
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>break</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span><span style=color:#b8860b>$i</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 在 while 语句中打破循环 :</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$i</span> = 0
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>while</span> (<span style=color:#b8860b>$true</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>if</span> (<span style=color:#b8860b>$i</span> <span style=color:#666>-eq</span> 5) {
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>break</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span><span style=color:#b8860b>$i</span>
</span></span><span style=display:flex><span>    <span style=color:#b8860b>$i</span>++
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=3-常用类型>3. 常用类型</h2><h3 id=--对象数组>- 对象数组</h3><blockquote><p><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_arrays?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于数组</a></p><p><a href="https://docs.microsoft.com/en-us/powershell/scripting/learn/deep-dives/everything-about-arrays?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于数组的各项须知内容</a></p></blockquote><p>在 PowerShell 中, 当然也存在数组, 通过以下方式来创建:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#080;font-style:italic># 语法 1:</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$var</span> = @(element 1, element 2, element 3, ...., element n)
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例:</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$array</span> = @(1, 3, 4, 5)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 语法 2:</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$var</span> = start..<span style=color:#a2f;font-weight:700>end</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例:</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$array</span> = @(1..5)    <span style=color:#080;font-style:italic># 生成的数组等同于: @(1, 2, 3, 4, 5)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 提示, @() 是可以省略的. 不过如果要创建空数组, 不可省略</span>
</span></span></code></pre></div><p>数组的访问, 与其他大多数编程语言一致, 通过中括号就可以:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f>echo </span>@(1..4)[2]   <span style=color:#080;font-style:italic># 输出 3</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$array</span> = @(1..4)
</span></span><span style=display:flex><span><span style=color:#b8860b>$array</span>[2] = 114514
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$array</span>[2]    <span style=color:#080;font-style:italic># 输出 114514</span>
</span></span></code></pre></div><p>PowerShell 的数组还支持获取多个值, 它返回一个新的数组:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$array</span> = @(1..4)
</span></span><span style=display:flex><span><span style=color:#b8860b>$array2</span> = <span style=color:#b8860b>$array</span>[0, 2]
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$array2</span>[0]   <span style=color:#080;font-style:italic># 输出 1</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$array2</span>[1]   <span style=color:#080;font-style:italic># 输出 3</span>
</span></span></code></pre></div><p>添加元素, 可以用 &lsquo;+=&rsquo; 运算符, 但注意, 不推荐这么做, 因为每为数组添加元素, 实际上都是重新创建了新的数组, 如果需要更灵活的数组, 请使用 泛型List</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$array</span> = @(1..4)
</span></span><span style=display:flex><span><span style=color:#b8860b>$array</span> += 114514
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$array</span>[4]    <span style=color:#080;font-style:italic># 输出 114514</span>
</span></span></code></pre></div><p>如果获取数组元素值时, 索引超出界限, 不会抛出异常, 会返回 null:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$array</span> = @(1..4)
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$array</span>[114514]  <span style=color:#080;font-style:italic># 不会有任何输出, 因为值是null</span>
</span></span></code></pre></div><p>如果对一个不是数组的变量使用索引操作符, 则会抛出异常:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$test</span> = <span style=color:#b8860b>$null</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$test</span>[0]          <span style=color:#080;font-style:italic># 抛出异常</span>
</span></span></code></pre></div><p>两个数组相加, 返回数组连接后的结果:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$array1</span> = @(1..3)
</span></span><span style=display:flex><span><span style=color:#b8860b>$array2</span> = @(3..1)
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span>(<span style=color:#b8860b>$array1</span> + <span style=color:#b8860b>$array2</span>)
</span></span></code></pre></div><p>输出:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>1
</span></span><span style=display:flex><span>2
</span></span><span style=display:flex><span>3
</span></span><span style=display:flex><span>3
</span></span><span style=display:flex><span>2
</span></span><span style=display:flex><span>1
</span></span></code></pre></div><p>使用 -contains 操作符来判断数组是否包含某元素:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$array</span> = @(1..4)
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span>(<span style=color:#b8860b>$array</span> <span style=color:#666>-contains</span> 2)    <span style=color:#080;font-style:italic># 输出 True</span>
</span></span></code></pre></div><p>在 PowerShell 的数组中, -eq 操作符将对所有元素进行判断, 即, 遍历内容, 逐一进行 -eq 运算, 如若有任何元素运算返回 True, 则表达式返回真.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$array</span> = @(1..4)
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span>(<span style=color:#b8860b>$array</span> <span style=color:#666>-eq</span> 3)          <span style=color:#080;font-style:italic># 返回 True</span>
</span></span></code></pre></div><p>如果判断一个变量(可能是数组)为空, 请不要将这个变量放在左侧:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$array</span> <span style=color:#666>-eq</span> <span style=color:#b8860b>$null</span>      <span style=color:#080;font-style:italic># 不要这样使用</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$null</span> <span style=color:#666>-eq</span> <span style=color:#b8860b>$array</span>      <span style=color:#080;font-style:italic># 正确的使用方式</span>
</span></span></code></pre></div><p>使用 Count 来获取一个数组的长度, 但注意, 如果一个变量值为null, 同样可以使用 count 来获取长度, 它返回 0:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$array</span> = @(1..4)
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$array</span>.Count     <span style=color:#080;font-style:italic># 返回 4</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$null</span>.Count      <span style=color:#080;font-style:italic># 返回 0</span>
</span></span></code></pre></div><p>你也可以通过 Length 来获取一个数组的长度, 它与 Count 用法一样, 并且如果是 $null, 同样返回 0.</p><h3 id=--哈希表>- 哈希表</h3><blockquote><p><a href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_hash_tables target=_blank rel=noopener>MSDocs PowerShell : 关于哈希表</a></p><p><a href="https://docs.microsoft.com/en-us/powershell/scripting/learn/deep-dives/everything-about-hashtable?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于哈希表的一些注意事项</a></p></blockquote><p>哈希表, 即 HashTable. 在 PowerShell 中这样创建 HashTable:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$table</span> = @{
</span></span><span style=display:flex><span>    key = value
</span></span><span style=display:flex><span>    key = value
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$table</span> = @{}            <span style=color:#080;font-style:italic># 创建空表</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$table</span> = @{             <span style=color:#080;font-style:italic># 创建有初始值的表, 下面的示例将使用这个表</span>
</span></span><span style=display:flex><span>    <span style=color:#b44>&#34;NullSlime&#34;</span> = 100
</span></span><span style=display:flex><span>    <span style=color:#b44>&#34;MoYuro&#34;</span> = 96
</span></span><span style=display:flex><span>    <span style=color:#b44>&#34;Muchen&#34;</span> = 94
</span></span><span style=display:flex><span>    <span style=color:#b44>&#34;KingHans&#34;</span> = 88
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>访问哈希表, 通过索引运算符, 指定键:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#080;font-style:italic># 使用刚刚创建的 table</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$table</span>[<span style=color:#b44>&#34;MoYuro&#34;</span>]    <span style=color:#080;font-style:italic># 输出 96</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$table</span>[<span style=color:#b44>&#34;MoYuro&#34;</span>] = 97
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$table</span>[<span style=color:#b44>&#34;MoYuro&#34;</span>]    <span style=color:#080;font-style:italic># 输出 97</span>
</span></span></code></pre></div><p>向表中添加键值对, 使用 Add 方法:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$table</span>.Add(key, value)
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$table</span>.Add(<span style=color:#b44>&#34;KunLong&#34;</span>, 76)
</span></span></code></pre></div><p>删除表中的某个键值对, 使用 Remove 方法:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$table</span>.Remove(key)
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$table</span>.Remove(<span style=color:#b44>&#34;KingHans&#34;</span>)
</span></span></code></pre></div><p>哈希表和数组一样支持选择多个值, 只需要在索引运算符中指定多个键:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$table</span><span style=color:#800>[key1, key2, ... , key n]</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$table</span>[(key1, key2, ... , key n)]
</span></span><span style=display:flex><span><span style=color:#b8860b>$table</span>[@(key1, key2, ... , key n)]
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$values</span> = <span style=color:#b8860b>$table</span>[<span style=color:#b44>&#34;NullSlime&#34;</span>, <span style=color:#b44>&#34;MoYuro&#34;</span>]    <span style=color:#080;font-style:italic># 返回一个数组</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$values</span>[0]                            <span style=color:#080;font-style:italic># 输出 100</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$values</span>[1]                            <span style=color:#080;font-style:italic># 输出 96</span>
</span></span></code></pre></div><p>通过 Keys 与 Values 来获取这个哈希表的所有键以及值</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$keys</span> = <span style=color:#b8860b>$tables</span>.Keys          <span style=color:#080;font-style:italic># 返回哈希表的所有键</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$values</span> = <span style=color:#b8860b>$tables</span>.Values      <span style=color:#080;font-style:italic># 返回哈希表的所有值</span>
</span></span></code></pre></div><p>可以通过对哈希表的枚举器来进行循环哈希表的每一个键值对:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f;font-weight:700>foreach</span> (<span style=color:#b8860b>$pair</span> <span style=color:#a2f;font-weight:700>in</span> <span style=color:#b8860b>$table</span>.GetEnumerator()) {
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span>(<span style=color:#b44>&#34;{0}: {1}&#34;</span> <span style=color:#666>-f</span> (<span style=color:#b8860b>$pair</span>.Key, <span style=color:#b8860b>$pair</span>.Value))
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>当通过foreach对哈希表进行迭代时, 不可以对哈希表进行删减:</p><h2 id=4-脚本函数>4. 脚本函数</h2><h3 id=--关于函数>- 关于函数</h3><blockquote><p><a href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions target=_blank rel=noopener>PowerShell 官方文档 : 关于函数</a></p></blockquote><p>PowerShell 中定义函数很简单, 它的本质是脚本块(ScriptBlock):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f;font-weight:700>function</span> name(parameters) {
</span></span><span style=display:flex><span>    statement block
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>function</span> myFunc(<span style=color:#b8860b>$a</span>, <span style=color:#b8860b>$b</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a2f>echo </span>(<span style=color:#b8860b>$a</span> + <span style=color:#b8860b>$b</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>调用 PowerShell 中定义的函数, 语法如下:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>name argv1 argv2 argv3 .... argv n
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span>myFunc 114000 514    <span style=color:#080;font-style:italic># 输出 114514</span>
</span></span></code></pre></div><p>如果要获取这个函数的对象引用 可以这样:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$function</span><span>:</span>name
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$function</span><span>:</span>myFunc
</span></span></code></pre></div><p>输出:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>param($a, $b)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo ($a + $b)
</span></span></code></pre></div><p>通过函数的对象引用, 可以使用 Invoke 来调用:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$function</span><span>:</span>name.Invoke(parameters)
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$function</span><span>:</span>myFunc.Invoke(114000, 514)    <span style=color:#080;font-style:italic># 输出 114514</span>
</span></span></code></pre></div><p>删除一个一定义的函数, 可以使用 del 语句:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f>del </span><span style=color:#a2f;font-weight:700>function</span><span>:</span>name
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#a2f>del </span><span style=color:#a2f;font-weight:700>function</span><span>:</span>myFunc
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$function</span><span>:</span>myFunc     <span style=color:#080;font-style:italic># 由于函数已删除, 所以不会有任何输出</span>
</span></span></code></pre></div><p>函数可以有返回值, 只需要使用 return 语句:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f;font-weight:700>function</span> myFunc(<span style=color:#b8860b>$a</span>, <span style=color:#b8860b>$b</span>) { <span style=color:#a2f;font-weight:700>return</span> <span style=color:#b8860b>$a</span> + <span style=color:#b8860b>$b</span>; }
</span></span><span style=display:flex><span><span style=color:#b8860b>$result</span> = myFunc 114000 514
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$result</span>      <span style=color:#080;font-style:italic># 输出 114514</span>
</span></span></code></pre></div><h2 id=5-面向对象>5. 面向对象</h2><h3 id=--使用对象>- 使用对象</h3><p>肯定会有人执行这个指令:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f>echo </span>Hello World!
</span></span></code></pre></div><p>虽然仅仅少了一对双引号, 但是, 它表示的意思其实跟之前我们写的完全不一样. 如果不加双引号, 那么在这个指令中, Hello 和 World! 会被认为是两个参数! 或者准确来说, 是两个对象!</p><p>这条没有加双引号的指令, 输出结果是:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Hello
</span></span><span style=display:flex><span>World!
</span></span></code></pre></div><p>另外, 命令的输出同样也是一个个对象, 执行下面的指令:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>1+1
</span></span></code></pre></div><p>输出</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>2
</span></span></code></pre></div><h3 id=--net-互操作>- .NET 互操作</h3><p>事实上, PowerShell 中的对象都是 .NET 对象. 并且我们可以进行 .NET 对象中所支持的操作. 执行下面的指令:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>(1+1).GetType()
</span></span></code></pre></div><p>输出:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>IsPublic IsSerial Name                                     BaseType
</span></span><span style=display:flex><span>-------- -------- ----                                     --------
</span></span><span style=display:flex><span>True     True     Int32                                    System.ValueType
</span></span></code></pre></div><p>这熟悉的命名空间, 可不就是 .NET 吗?</p><p>试试以下指令:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>(<span style=color:#a2f>echo </span>123).GetType()
</span></span></code></pre></div><p>输出:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>IsPublic IsSerial Name                                     BaseType
</span></span><span style=display:flex><span>-------- -------- ----                                     --------
</span></span><span style=display:flex><span>True     True     Int32                                    System.ValueType
</span></span></code></pre></div><p>好家伙, 原来 echo 直接就是把这个对象输出出来对吧!</p><p>而事实上, 一个表达式的运算结果(返回值), 是会打印到控制台的, 这点与 Python 一样.</p><p>所以如果你执行一个 &lsquo;1+1&rsquo;, 这个表达式的运算结果是 2, 则 2 会被打印到控制台.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>1+1  <span style=color:#080;font-style:italic># 输出 2</span>
</span></span></code></pre></div><p>如果你不希望一个语句的返回值被打印到控制台, 可以在首部添加 [void], 它表示将语句的返回值强制转换为 void 以保证没有输出</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#800>[void]</span>(1+1)    <span style=color:#080;font-style:italic># 没有输出</span>
</span></span></code></pre></div><p>使用 New-Object 可以创建一个对象, 指定 .NET 对象的全名即可创建:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$random</span> = <span style=color:#a2f>New-Object</span> System.Random
</span></span><span style=display:flex><span><span style=color:#b8860b>$randint</span> = <span style=color:#b8860b>$random</span>.Next()    <span style=color:#080;font-style:italic># 调用 System.Random 对象的 Next 方法</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$randint</span>                <span style=color:#080;font-style:italic># 输出一个随机的数字</span>
</span></span></code></pre></div><p>如果需要带参数的创建 .NET 对象, 直接在 New-Object 语句后添加参数数组即可:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$str</span> = <span style=color:#a2f>New-Object</span> String (<span style=color:#b44>&#39;草&#39;</span>, 20)    <span style=color:#080;font-style:italic># 生草</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo </span><span style=color:#b8860b>$str</span>  <span style=color:#080;font-style:italic># 返回 &#39;草草草草草草草草草草草草草草草草草草草草&#39;</span>
</span></span></code></pre></div><p>PowerShell 中的强制类型转换是这样使用的:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>[类型]对象
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$numArray</span> = <span style=color:#800>[int[]]</span>(1..4)   <span style=color:#080;font-style:italic># 将 object[] 转换为 int[]</span>
</span></span></code></pre></div><p>调用 .NET 类的静态方法, 使用下面的语法:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>[类的全名]::方法名(参数)
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 示例 :</span>
</span></span><span style=display:flex><span><span style=color:#800>[Console]</span>::WriteLine(<span style=color:#b44>&#34;Hello world!&#34;</span>)   <span style=color:#080;font-style:italic># 输出 Hello world</span>
</span></span></code></pre></div><p>访问字段, 也是一样的</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b8860b>$ansi</span> = <span style=color:#800>[System.Text.Encoding]</span>::<span style=color:#a2f;font-weight:700>Default</span>
</span></span></code></pre></div><p>如果要使用某个命名空间, 使用下面的语句:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>using namespace System.Text
</span></span><span style=display:flex><span><span style=color:#b8860b>$ansi</span> = <span style=color:#800>[Encoding]</span>::<span style=color:#a2f;font-weight:700>Default</span>
</span></span></code></pre></div><p>值得高兴的是, 通过调用 .NET 的组件, 你甚至可以在 PowerShell 中创建 UI 窗体, 下面是一个简单的示例代码:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#a2f>Add-Type</span> -AssemblyName System.Windows.Forms
</span></span><span style=display:flex><span><span style=color:#a2f>Add-Type</span> -AssemblyName System.Drawing
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span> = <span style=color:#a2f>New-Object</span> System.Windows.Forms.Form
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.Text = <span style=color:#b44>&#39;Select a Computer&#39;</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.Size = <span style=color:#a2f>New-Object</span> System.Drawing.Size(300,200)
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.StartPosition = <span style=color:#b44>&#39;CenterScreen&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$okButton</span> = <span style=color:#a2f>New-Object</span> System.Windows.Forms.Button
</span></span><span style=display:flex><span><span style=color:#b8860b>$okButton</span>.Anchor = <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Bottom <span style=color:#666>-bor</span> <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Right
</span></span><span style=display:flex><span><span style=color:#b8860b>$okButton</span>.Location = <span style=color:#a2f>New-Object</span> System.Drawing.Point(75,120)
</span></span><span style=display:flex><span><span style=color:#b8860b>$okButton</span>.Size = <span style=color:#a2f>New-Object</span> System.Drawing.Size(75,23)
</span></span><span style=display:flex><span><span style=color:#b8860b>$okButton</span>.Text = <span style=color:#b44>&#39;OK&#39;</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$okButton</span>.DialogResult = <span style=color:#800>[System.Windows.Forms.DialogResult]</span>::OK
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.AcceptButton = <span style=color:#b8860b>$okButton</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.Controls.Add(<span style=color:#b8860b>$okButton</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$cancelButton</span> = <span style=color:#a2f>New-Object</span> System.Windows.Forms.Button
</span></span><span style=display:flex><span><span style=color:#b8860b>$cancelButton</span>.Anchor = <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Bottom <span style=color:#666>-bor</span> <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Right
</span></span><span style=display:flex><span><span style=color:#b8860b>$cancelButton</span>.Location = <span style=color:#a2f>New-Object</span> System.Drawing.Point(150,120)
</span></span><span style=display:flex><span><span style=color:#b8860b>$cancelButton</span>.Size = <span style=color:#a2f>New-Object</span> System.Drawing.Size(75,23)
</span></span><span style=display:flex><span><span style=color:#b8860b>$cancelButton</span>.Text = <span style=color:#b44>&#39;Cancel&#39;</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$cancelButton</span>.DialogResult = <span style=color:#800>[System.Windows.Forms.DialogResult]</span>::Cancel
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.CancelButton = <span style=color:#b8860b>$cancelButton</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.Controls.Add(<span style=color:#b8860b>$cancelButton</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$label</span> = <span style=color:#a2f>New-Object</span> System.Windows.Forms.Label
</span></span><span style=display:flex><span><span style=color:#b8860b>$label</span>.Anchor = <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Top <span style=color:#666>-bor</span> <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Left
</span></span><span style=display:flex><span><span style=color:#b8860b>$label</span>.Location = <span style=color:#a2f>New-Object</span> System.Drawing.Point(10,20)
</span></span><span style=display:flex><span><span style=color:#b8860b>$label</span>.Size = <span style=color:#a2f>New-Object</span> System.Drawing.Size(280,20)
</span></span><span style=display:flex><span><span style=color:#b8860b>$label</span>.Text = <span style=color:#b44>&#39;Please select a computer:&#39;</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.Controls.Add(<span style=color:#b8860b>$label</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$listBox</span> = <span style=color:#a2f>New-Object</span> System.Windows.Forms.ListBox
</span></span><span style=display:flex><span><span style=color:#b8860b>$listBox</span>.Anchor = <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Top <span style=color:#666>-bor</span> <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Left <span style=color:#666>-bor</span> <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Bottom <span style=color:#666>-bor</span> <span style=color:#800>[System.Windows.Forms.AnchorStyles]</span>::Right
</span></span><span style=display:flex><span><span style=color:#b8860b>$listBox</span>.Location = <span style=color:#a2f>New-Object</span> System.Drawing.Point(10,40)
</span></span><span style=display:flex><span><span style=color:#b8860b>$listBox</span>.Size = <span style=color:#a2f>New-Object</span> System.Drawing.Size(260,20)
</span></span><span style=display:flex><span><span style=color:#b8860b>$listBox</span>.Height = 80
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#800>[void]</span> <span style=color:#b8860b>$listBox</span>.Items.Add(<span style=color:#b44>&#39;atl-dc-001&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#800>[void]</span> <span style=color:#b8860b>$listBox</span>.Items.Add(<span style=color:#b44>&#39;atl-dc-002&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#800>[void]</span> <span style=color:#b8860b>$listBox</span>.Items.Add(<span style=color:#b44>&#39;atl-dc-003&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#800>[void]</span> <span style=color:#b8860b>$listBox</span>.Items.Add(<span style=color:#b44>&#39;atl-dc-004&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#800>[void]</span> <span style=color:#b8860b>$listBox</span>.Items.Add(<span style=color:#b44>&#39;atl-dc-005&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#800>[void]</span> <span style=color:#b8860b>$listBox</span>.Items.Add(<span style=color:#b44>&#39;atl-dc-006&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#800>[void]</span> <span style=color:#b8860b>$listBox</span>.Items.Add(<span style=color:#b44>&#39;atl-dc-007&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.Controls.Add(<span style=color:#b8860b>$listBox</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$form</span>.Topmost = <span style=color:#b8860b>$true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b8860b>$result</span> = <span style=color:#b8860b>$form</span>.ShowDialog()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>if</span> (<span style=color:#b8860b>$result</span> <span style=color:#666>-eq</span> <span style=color:#800>[System.Windows.Forms.DialogResult]</span>::OK)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#b8860b>$x</span> = <span style=color:#b8860b>$listBox</span>.SelectedItem
</span></span><span style=display:flex><span>    <span style=color:#800>[System.Windows.Forms.MessageBox]</span>::Show(<span style=color:#b44>&#34;你选择了:&#34;</span> + <span style=color:#b8860b>$x</span>.ToString())
</span></span><span style=display:flex><span>} <span style=color:#a2f;font-weight:700>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#800>[System.Windows.Forms.MessageBox]</span>::Show(<span style=color:#b44>&#34;你没有选择任何条目&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><footer class=post-footer><div class=post-tags><a href=/tags/.net rel=tag title=.NET>#.NET#</a>
<a href=/tags/powershell rel=tag title=PowerShell>#PowerShell#</a>
<a href=/tags/%e6%95%99%e7%a8%8b rel=tag title=教程>#教程#</a>
<a href=/tags/%e7%ac%94%e8%ae%b0 rel=tag title=笔记>#笔记#</a></div><div class=addthis_inline_share_toolbox></div><div class=post-nav><div class=article-copyright><div class=article-copyright-info><p><span>标题：</span>PowerShell 快速入门, 基本语法, 常用类型, 函数, .NET 互操作</p><p><span>链接：</span>https://slimenull.top/post/pwsh-getstarted/</p><p><span>作者：</span>史莱姆诺尔</p><p><span>声明： </span>本博客文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/3.0/ target=_blank style=text-decoration:underline>CC BY-NC-SA 3.0</a>许可协议，转载请注明出处！</p></div></div><div class=clear></div></div><div class=reward-qr-info><div>创作实属不易，如有帮助，那就打赏博主些许茶钱吧 ^_^</div><button id=rewardButton disable=enable onclick='var qr=document.getElementById("QR");qr.style.display==="none"?qr.style.display="block":qr.style.display="none"'>
<span>赏</span></button><div id=QR style=display:none><div id=wechat style=display:inline-block><img id=wechat_qr src=/img/wechat-pay.png alt="WeChat Pay"><p>微信打赏</p></div><div id=alipay style=display:inline-block><img id=alipay_qr src=/img/ali-pay.png alt=Alipay><p>支付宝打赏</p></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=https://slimenull.top/post/java-variableandexpr/ rel=next title="[Java] 变量与表达式"><i class="fa fa-chevron-left"></i> [Java] 变量与表达式</a></div><div class="post-nav-prev post-nav-item"><a href=https://slimenull.top/post/error-dotnet-wpf-dragdrop/ rel=prev title="[C#] WPF TextBox 在 PreviewDragEnter 中指定 Effect 且指定 Handled 为 true, 仍然无法正常实现拖拽操作.">[C#] WPF TextBox 在 PreviewDragEnter 中指定 Effect 且指定 Handled 为 true, 仍然无法正常实现拖拽操作.
<i class="fa fa-chevron-right"></i></a></div></div><div id=wcomments></div></footer></article></section></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><section class="site-overview sidebar-panel sidebar-panel-active"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image src=/img/avatar.jpg alt=史莱姆诺尔><p class=site-author-name itemprop=name>史莱姆诺尔</p><p class="site-description motion-element" itemprop=description>我很可爱, 请给我糖 o(*////▽////*)q</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=/post/><span class=site-state-item-count>83</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>0</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>43</span>
<span class=site-state-item-name>标签</span></a></div></nav><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/slimenull/ target=_blank title=GitHub><i class="fa fa-fw fa-github"></i>
GitHub</a></span>
<span class=links-of-author-item><a href=https://space.bilibili.com/441842015 target=_blank title=Bilibili><i class="fa fa-fw fa-tv"></i>
Bilibili</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class=links-of-blogroll-title><i class="fa fa-fw fa-globe"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://vertillusion.xyz/ title=Vertillusion target=_blank>Vertillusion</a></li></ul></div><div class="tagcloud-of-blogroll motion-element tagcloud-of-blogroll-inline"><div class=tagcloud-of-blogroll-title><i class="fa fa-fw fa-tags"></i>
标签云</div><ul class=tagcloud-of-blogroll-list><li class=tagcloud-of-blogroll-item><a href=/tags/.net>.Net
<sup>54</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/c>C#
<sup>45</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E7%AC%94%E8%AE%B0>笔记
<sup>36</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E8%BD%AE%E5%AD%90>轮子
<sup>16</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E5%8F%82%E8%80%83>参考
<sup>12</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E7%AE%97%E6%B3%95>算法
<sup>8</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E7%BB%8F%E9%AA%8C>经验
<sup>8</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/wpf>Wpf
<sup>7</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/linux>Linux
<sup>6</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E6%95%99%E7%A8%8B>教程
<sup>6</sup></a></li></ul></div></section></div></aside></div></main><footer id=footer class=footer><div class=footer-inner><div class=copyright><span class=copyright-year>&copy; 2010 - 2022</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=copyright-author>诺尔的小窝</span></div><div class=powered-info><span class=powered-by>Powered by - <a class=powered-link href=//gohugo.io target=_blank title=hugo>Hugo v0.95.0</a></span>
<span class=separator-line>/</span>
<span class=theme-info>Theme by - <a class=powered-link href=//github.com/elkan1788/hugo-theme-next target=_blank>NexT</a></span></div><div class=vistor-info><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span class=site-uv><i class="fa fa-user"></i>
<span class=busuanzi-value id=busuanzi_value_site_uv></span></span>
<span class=separator-line>/</span>
<span class=site-pv><i class="fa fa-eye"></i>
<span class=busuanzi-value id=busuanzi_value_site_pv></span></span></div><div class=license-info><span class=storage-info>Storage by
<a href=https://www.ucloud.cn/ style=font-weight:700 target=_blank>UCloud云存储</a></span>
<span class=separator-line>/</span>
<span class=license-num><a href=http://beian.miit.gov.cn target=_blank>粤ICP备18047355号</a></span></div></div></footer><div class=back-to-top><i class="fa fa-arrow-up"></i>
<span id=scrollpercent><span>0</span>%</span></div></div><script type=text/javascript src=//unpkg.com/jquery@2.1.4/dist/jquery.min.js></script>
<script type=text/javascript src=https://slimenull.topjs/search.js></script>
<script type=text/javascript src=https://slimenull.topjs/affix.js></script>
<script type=text/javascript src=https://slimenull.topjs/scrollspy.js></script>
<script type=text/javascript>function detectIE(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),s=e.indexOf("Edge/");return t>0||n>0||s>0?-1:1}function getCntViewHeight(){var t=$("#content").height(),e=$(window).height(),n=t>e?t-e:$(document).height()-e;return n}function getScrollbarWidth(){var e=$("<div />").addClass("scrollbar-measure").prependTo("body"),t=e[0],n=t.offsetWidth-t.clientWidth;return e.remove(),n}function registerBackTop(){var t=50,e=$(".back-to-top");$(window).on("scroll",function(){e.toggleClass("back-to-top-on",window.pageYOffset>t);var s=$(window).scrollTop(),o=getCntViewHeight(),i=s/o,n=Math.round(i*100),a=n>100?100:n;$("#scrollpercent>span").html(a)}),e.on("click",function(){$("html,body").animate({scrollTop:0,screenLeft:0},800)})}function initScrollSpy(){var e=".post-toc",s=$(e),t=".active-current";s.on("activate.bs.scrollspy",function(){var t=$(e+" .active").last();n(),t.addClass("active-current")}).on("clear.bs.scrollspy",n),$("body").scrollspy({target:e});function n(){$(e+" "+t).removeClass(t.substring(1))}}function initAffix(){var e=$(".header-inner").height(),t=parseInt($(".main").css("padding-bottom"),10),n=e+10;$(".sidebar-inner").affix({offset:{top:n,bottom:t}}),$(document).on("affixed.bs.affix",function(){updateTOCHeight(document.body.clientHeight-100)})}function initTOCDimension(){$(window).on("resize",function(){e&&clearTimeout(e),e=setTimeout(function(){var e=document.body.clientHeight-100;updateTOCHeight(e)},0)}),updateTOCHeight(document.body.clientHeight-100);var e,t=getScrollbarWidth();$(".post-toc").css("width","calc(100% + "+t+"px)")}function updateTOCHeight(e){e=e||"auto",$(".post-toc").css("max-height",e)}$(function(){var t=$(".header-inner").height()+10,n,s,e,o;$("#sidebar").css({'margin-top':t}).show(),n=parseInt($("#sidebar").css("margin-top")),s=parseInt($(".sidebar-inner").css("height")),e=n+s,o=$(".content-wrap").height(),o<e&&$(".content-wrap").css("min-height",e),$(".site-nav-toggle").on("click",function(){var e=$(".site-nav"),o=$(".toggle"),t="site-nav-on",i="toggle-close",n=e.hasClass(t),a=n?"slideUp":"slideDown",s=n?"removeClass":"addClass";e.stop()[a]("normal",function(){e[s](t),o[s](i)})}),registerBackTop(),initScrollSpy(),initAffix(),initTOCDimension(),$(".sidebar-nav-toc").click(function(){$(this).addClass("sidebar-nav-active"),$(this).next().removeClass("sidebar-nav-active"),$("."+$(this).next().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)}),$(".sidebar-nav-overview").click(function(){$(this).addClass("sidebar-nav-active"),$(this).prev().removeClass("sidebar-nav-active"),$("."+$(this).prev().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)})})</script><script src=//unpkg.com/imageviewer@1.1.0/dist/viewer.min.js></script>
<script type=text/javascript>$(function(){$(".post-body").viewer()})</script><script type=text/javascript>const locale={placeholder:"欢迎留下您的宝贵建议，请填写您的昵称和邮箱便于后续交流. ^_^"};$(function(){detectIE()>0?$.getScript(document.location.protocol+"//unpkg.com/@waline/client@1.6.0/dist/Waline.min.js",function(){new Waline({el:"#wcomments",visitor:!0,emoji:[],wordLimit:"200",uploadImage:!1,locale,requiredMeta:["nick","mail"],serverURL:"https://hugo-blog-api-slimenull.vercel.app/",lang:"zh-cn"})}):$("#wcomments").html("抱歉，Waline插件不支持IE，建议使用Chrome浏览器。")})</script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=623eced69d98b93c"></script>
<script>(function(){var e=document.createElement("script"),t,n=window.location.protocol.split(":")[0];n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script></body></html>